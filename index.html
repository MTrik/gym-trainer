<!doctype html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Курсы</title>
	<style>
		html, body { margin:0; padding:16px; background:#fff; color:#000; }
		.grid {
			display:grid;
			gap:8px;
			grid-template-columns: repeat(3, minmax(80px, 1fr));
			align-items:center;
		}
		.cell {
			font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial;
		}
		/* Никаких заголовков, линий и рамок — только цифры */
	</style>
</head>
<body>
	<div id="rates" class="grid" aria-label="Курсы"></div>

	<script>
	const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQUb0EbKC3P-s1OaXzPLuMHY1AksyyQc9UTVpzgzoshVpBVLyxqiriPGWICqC74p_vyt0wqzndYYyUf/pub?gid=597818720&single=true&output=tsv'; // ссылка на опубликованный CSV

	// Парсер CSV (простой). Если в ячейках есть запятые/кавычки, лучше использовать PapaParse.
	function parseCSV(text) {
		const rows = text.trim().split(/\r?\n/).map(r => r.split(','));
		if (!rows.length) return [];
		// Первая строка — заголовки: Range, EUR, RUB, USDT
		const [header, ...data] = rows;
		const map = Object.fromEntries(header.map((h,i)=>[h.trim().toLowerCase(), i]));
		const iEUR = map['eur'], iRUB = map['rub'], iUSDT = map['usdt'];
		// Если нет нужных столбцов — выводим всё как есть
		if ([iEUR, iRUB, iUSDT].some(v => v === undefined)) {
			return data.map(cols => cols);
		}
		return data.map(cols => [cols[iEUR] ?? '', cols[iRUB] ?? '', cols[iUSDT] ?? '']);
	}

	async function load() {
		const res = await fetch(CSV_URL, { cache: 'no-store' });
		const text = await res.text();
		const rows = parseCSV(text);
		const grid = document.getElementById('rates');

		// Если структура стандартная — выводим 3 колонки (EUR, RUB, USDT).
		// Иначе выводим как есть, по 3 колонки в ряд, без заголовков.
		const standard = rows.every(r => r.length === 3);
		if (standard) {
			grid.innerHTML = rows.map(([eur, rub, usdt]) => `
				<div class="cell">${eur || ''}</div>
				<div class="cell">${rub || ''}</div>
				<div class="cell">${usdt || ''}</div>
			`).join('');
		} else {
			grid.style.gridTemplateColumns = 'repeat(3, minmax(80px, 1fr))';
			grid.innerHTML = rows.flat().map(v => `<div class="cell">${v || ''}</div>`).join('');
		}
	}

	load().catch(err => {
		console.error(err);
		document.getElementById('rates').textContent = 'Не удалось загрузить данные.';
	});
	</script>
</body>
</html>
